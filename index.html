<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Orden de Retiro / Encuesta de Devolución de Equipo</title>
<style>
:root{
  --line:#1e293b;
  --muted:#334155;
  --bg:#ffffff;
  --accent:#0f172a;
  --error:#dc2626;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: "Segoe UI", Roboto, Arial, sans-serif;
  background:#f6f7fb;
  color:#0b0f19;
  padding: 12px;
  line-height:1.5;
}

/* Contenedor principal */
.sheet{
  max-width: 900px;
  margin: 18px auto;
  background: var(--bg);
  border: 2px solid var(--line);
  border-radius: 10px;
  box-shadow: 0 8px 24px rgba(2,6,23,.1);
  padding: 20px;
}

/* Encabezado */
header{
  display:grid;
  grid-template-columns: 1fr auto;
  align-items:center;
  gap:16px;
  padding:12px 16px;
  border:2px solid var(--line);
  border-radius:8px;
}
header h1{
  margin:0;
  font-size: 22px;
  font-weight: 700;
  letter-spacing:.5px;
  text-transform: uppercase;
  color: var(--accent);
}
.badge{
  font-size:13px;
  font-weight:500;
  color:#475569;
  margin-top:4px;
}
.logo{
  width:82px;height:82px;
  border:2px solid var(--line);
  display:grid;place-items:center;
  border-radius:6px;
  overflow:hidden;
}
.logo img{
  width:100%;
  height:100%;
  object-fit:contain;
}

/* Bloques */
.block{
  border:2px solid var(--line);
  margin-top:22px;
  border-radius:8px;
  overflow:hidden;
}
.block .title{
  background:#eef2ff;
  border-bottom:2px solid var(--line);
  padding:10px 14px;
  font-weight:700;
  text-transform:uppercase;
  letter-spacing:.4px;
  font-size:14px;
  color: var(--accent);
}
.block .content{
  padding:14px 16px;
}

/* Grillas */
.grid-2{display:grid; grid-template-columns: 1fr 1fr; gap:14px}
.grid-3{display:grid; grid-template-columns: repeat(3, minmax(0,1fr)); gap:14px}
.grid-4{display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:14px}

/* Inputs */
label{
  font-size:13px;
  text-transform:uppercase;
  letter-spacing:.4px;
  color:var(--muted);
  display:block;
  margin-bottom:6px;
  font-weight:600;
}
input[type="text"],
input[type="date"],
input[type="tel"],
input[type="number"],
input[type="email"],
select,
textarea{
  width:100%;
  max-width:100%;
  padding:10px 12px;
  border:2px solid var(--line);
  border-radius:6px;
  font-size:15px;
  outline:none;
  background:#fff;
  transition:border-color .2s, box-shadow .2s;
}
textarea{min-height:100px; resize:vertical}

input:focus, select:focus, textarea:focus{
  border-color:var(--accent);
  box-shadow:0 0 0 2px rgba(15,23,42,.2);
}

/* Solo se marcan en rojo si el usuario ya interactuó con el campo */
input:focus:invalid,
select:focus:invalid,
textarea:focus:invalid {
  border-color: var(--error);
  background-color: #fee2e2;
}


/* Checklines */
.checkline{
  display:grid;
  grid-template-columns: 1.3fr repeat(2,.7fr);
  gap:12px; 
  align-items:center;
  border-bottom:1px dashed #cbd5e1; 
  padding:10px 0;
}
.checkline:last-child{border-bottom:none}
.checkline > label {
  font-weight: 700;
  font-size: 14px;
  color: var(--accent);
}
.checkgroup{
  display:flex; gap:6px; align-items:center;
  justify-content:flex-start;
  font-size:14px;
}
.checkgroup input{transform:translateY(1px)}

/* Acciones */
.actions{
  display:flex; gap:12px; justify-content:flex-end; margin-top:22px
}
button{
  border:2px solid var(--accent);
  background:var(--accent);
  color:#fff;
  padding:12px 18px;
  border-radius:8px;
  font-weight:600;
  cursor:pointer;
  font-size:15px;
  transition:all .2s;
  box-shadow:0 3px 6px rgba(0,0,0,.12);
}
button.secondary{
  background:#fff;color:var(--accent);
}
button:hover{opacity:.9; transform:translateY(-1px)}

/* Firma */
.block.signature {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 16px;
}
#firmaVendedor {
  width: 100%;
  max-width: 520px; 
  height: 150px; 
  border: 2px solid var(--line);
  border-radius: 6px;
  background-color: #fff;
  margin-bottom: 12px;
}
.block.signature button {
  padding: 10px 20px;
  font-size: 14px;
  border-radius: 6px;
  border: 2px solid var(--accent);
  background: var(--accent);
  color: #fff;
  cursor: pointer;
  transition: opacity 0.2s, transform 0.2s;
}
.block.signature button:hover {
  opacity: 0.9;
  transform:translateY(-1px);
}

/* Responsive */
@media (max-width: 768px) {
  .grid-2,
  .grid-3,
  .grid-4 {
    grid-template-columns: 1fr !important;
  }

  header {
    grid-template-columns: 1fr;
    text-align: center;
  }
  .logo {margin: 12px auto 0;}

  .actions {flex-direction: column;}
  .actions button {width: 100%;}

  .checkline {
    grid-template-columns: 1fr !important;
    text-align: center;
    padding:10px 0;
  }
  .checkline > label {margin-bottom:8px;}
  .checkgroup {
    justify-content:center;
    margin-bottom:4px;
  }

  #firmaVendedor {
    max-width: 100%;
    height: 200px;
  }
  .block.signature button {width: 100%;}
}

/* Impresión */
@media print{
  body{background:#fff}
  .sheet{box-shadow:none; margin:0; border-radius:0; border-width:1px}
  .actions{display:none}
  a[href]:after{content:""}
}
</style>
</head>
<body>
<form class="sheet" id="formRetiro">

<header>
  <div>
    <h1>Orden de Retiro de Activo Promocional</h1>
    <div class="badge">Encuesta / Acta de Devolución</div>
  </div>
  <div class="logo">
    <img src="maravilla.png" alt="Logo Empresa">
  </div>
</header>

<div class="block">
  <div class="title">Correo de destino</div>
  <div class="content">
    <label for="correoDestino">Ingrese el correo al que quiere enviar</label>
    <input id="correoDestino" name="correoDestino" type="email" required placeholder="ejemplo@correo.com">
  </div>
</div>

<div class="block">
  <div class="title">Motivo y fecha</div>
  <div class="content grid-3">
    <div>
      <label for="motivo">Motivo del retiro</label>
      <select id="motivo" name="motivo" required>
        <option value="" hidden>Seleccione…</option>
        <option>Baja Rotacion</option>
        <option>Negocio Cerrado</option>
        <option>Cliente Insatisfecho</option>
        <option>Falla de Congelador</option>
        <option>Otro</option>
      </select>
    </div>
    <div>
      <label for="lugar">Lugar</label>
      <input id="lugar" name="lugar" type="text" required placeholder="Ciudad / Municipio">
    </div>
    <div>
      <label for="fecha">Fecha</label>
      <input id="fecha" name="fecha" type="date" required>
    </div>
  </div>
</div>

<div class="block">
  <div class="title">Información del negocio</div>
  <div class="content">
    <div class="grid-4">
      <div>
        <label for="region">Región BNC</label>
        <input id="region" name="region" type="text" required>
      </div>
      <div>
        <label for="codigoBNC">Código BNC</label>
        <input id="codigoBNC" name="codigoBNC" type="text" required>
      </div>
      <div>
        <label for="agencia">Agencia BNC</label>
        <input id="agencia" name="agencia" type="text" required>
      </div>
      <div>
        <label for="distrito">Ruta</label>
        <input id="distrito" name="distrito" type="text" required>
      </div>
    </div>
    <div class="grid-2" style="margin-top:10px">
      <div>
        <label for="negocio">Nombre del negocio</label>
        <input id="negocio" name="negocio" type="text" required>
      </div>
      <div>
        <label for="direccion">Dirección del negocio</label>
        <input id="direccion" name="direccion" type="text" required placeholder="Calle, avenida, zona, municipio">
      </div>
    </div>
  </div>
</div>

<div class="block">
  <div class="title">Información del propietario del negocio</div>
  <div class="content grid-3">
    <div>
      <label for="propietario">Nombre del propietario</label>
      <input id="propietario" name="propietario" type="text" required>
    </div>
    <div>
      <label for="encargado">Nombre del encargado</label>
      <input id="encargado" name="encargado" type="text" required>
    </div>
    <div>
      <label for="telProp">Teléfono</label>
      <input id="telProp" name="telProp" type="tel" required placeholder="####-####">
    </div>
  </div>
</div>

<div class="block">
  <div class="title">Características del equipo frío</div>
  <div class="content grid-4">
    <div>
      <label for="modelo">Modelo</label>
      <input id="modelo" name="modelo" type="text" required>
    </div>
    <div>
      <label for="serie">Serie</label>
      <input id="serie" name="serie" type="text" required>
    </div>
    <div>
      <label for="sombrilla"># de Equipo</label>
      <input id="sombrilla" name="sombrilla" type="text" required>
    </div>
    <div>
      <label for="vendedor">Nombre vendedor</label>
      <input id="vendedor" name="vendedor" type="text" required>
    </div>
    <div>
      <label for="telVend">Teléfono vendedor</label>
      <input id="telVend" name="telVend" type="tel" required placeholder="####-####">
    </div>
    <div>
      <label for="supervisor">Nombre supervisor</label>
      <input id="supervisor" name="supervisor" type="text" required>
    </div>
    <div>
      <label for="telSup">Teléfono supervisor</label>
      <input id="telSup" name="telSup" type="tel" required placeholder="####-####">
    </div>
  </div>
</div>

<div class="block">
  <div class="title">Estado de la devolución del equipo</div>
  <div class="content">
    <div class="checkline">
      <label>Imagen / Rotulación</label>
      <div class="checkgroup">
        <input type="radio" id="img-b" name="imagen" value="buen" required>
        <label for="img-b">Buen estado</label>
      </div>
      <div class="checkgroup">
        <input type="radio" id="img-m" name="imagen" value="mal">
        <label for="img-m">Mal estado</label>
      </div>
    </div>
    <div class="checkline">
      <label>Canastas</label>
      <div class="checkgroup">
        <input type="radio" id="can-c" name="canastas" value="completas" required>
        <label for="can-c">Completas</label>
      </div>
      <div class="checkgroup">
        <input type="radio" id="can-nc" name="canastas" value="no-completas">
        <label for="can-nc">No completas</label>
      </div>
    </div>
    <div class="checkline">
      <label>Rodos</label>
      <div class="checkgroup">
        <input type="radio" id="rod-b" name="rodos" value="buen" required>
        <label for="rod-b">Buen estado</label>
      </div>
      <div class="checkgroup">
        <input type="radio" id="rod-m" name="rodos" value="mal">
        <label for="rod-m">Mal estado</label>
      </div>
    </div>
    <div class="checkline">
      <label>Puertas</label>
      <div class="checkgroup">
        <input type="radio" id="pue-b" name="puertas" value="buen" required>
        <label for="pue-b">Buen estado</label>
      </div>
      <div class="checkgroup">
        <input type="radio" id="pue-m" name="puertas" value="mal">
        <label for="pue-m">Mal estado</label>
      </div>
    </div>
    <div class="checkline">
      <label>Burrito de comunicación</label>
      <div class="checkgroup">
        <input type="radio" id="bur-s" name="burrito" value="si" required>
        <label for="bur-s">Sí</label>
      </div>
      <div class="checkgroup">
        <input type="radio" id="bur-n" name="burrito" value="no">
        <label for="bur-n">No</label>
      </div>
    </div>
    <div class="checkline">
      <label>Devolución de llaves</label>
      <div class="checkgroup">
        <input type="radio" id="llav-s" name="llaves" value="si" required>
        <label for="llav-s">Sí</label>
      </div>
      <div class="checkgroup">
        <input type="radio" id="llav-n" name="llaves" value="no">
        <label for="llav-n">No</label>
      </div>
    </div>
  </div>
</div>

<div class="block">
  <div class="title">Observaciones</div>
  <div class="content">
    <textarea id="obs" name="observaciones" required placeholder="Ej.: Tiene baja rotación de helados, detalles estéticos, etc."></textarea>
  </div>
</div>

<div class="block signature">
  <div class="title">Firma del vendedor</div>
  <canvas id="firmaVendedor" class="signature-pad"></canvas>
  <button type="button">Borrar</button>
  <input type="hidden" name="firmaVendedor" id="firmaVendedorHidden">
</div>

<div class="actions">
  <button type="button" class="secondary" onclick="window.print()">Imprimir / PDF</button>
  <button type="submit">Enviar encuesta</button>
</div>
</form>

<script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.0/dist/signature_pad.umd.min.js"></script>
<script>
// Inicializar Signature Pad
const canvas = document.getElementById("firmaVendedor");
const signaturePad = new SignaturePad(canvas, {
  backgroundColor: 'rgba(255, 255, 255, 0)',
  penColor: 'rgb(0, 0, 0)',
});

// Ajustar canvas al tamaño del contenedor
function resizeCanvas() {
  const ratio = Math.max(window.devicePixelRatio || 1, 1);
  canvas.width = canvas.offsetWidth * ratio;
  canvas.height = canvas.offsetHeight * ratio;
  canvas.getContext("2d").scale(ratio, ratio);
  signaturePad.clear();
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

// Botón borrar firma
document.querySelector(".block.signature button").addEventListener("click", () => {
  signaturePad.clear();
});

// Manejo del submit del formulario
document.getElementById("formRetiro").addEventListener("submit", function(event){
  event.preventDefault();

  if(signaturePad.isEmpty()){
    alert("Por favor, dibuje la firma antes de enviar.");
    return;
  }

  document.getElementById("firmaVendedorHidden").value = signaturePad.toDataURL();

  emailjs.sendForm("service_5wz8ct2", "template_y4a3bvp", this)
    .then(()=>{
      alert("✅ Encuesta enviada correctamente.");
      this.reset();
      signaturePad.clear();
    })
    .catch((err)=>{
      console.error(err);
      alert("❌ Error al enviar la encuesta. Intenta de nuevo.");
    });
});
</script>
</body>
</html>
